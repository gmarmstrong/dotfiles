#!/bin/bash

echo "This script isn't done yet!"
exit 0

. "$HOME/dotfiles/scripts/functions.sh"

test_internet_connection
check_user_privileges
git_setup
symlink_agnostic_dotfiles
test $operating_system == Darwin && symlink_darwin_dotfiles
test $operating_system == Linux && symlink_linux_dotfiles

# Set up package manager and install programs
if [ sudo -v ]
    case $operating_sytem in
        Linux)
            case $linux_distro in
                Debian) aptget_setup ;;
                Ubuntu) aptget_setup ;;
                RedHat) yum_setup ;;
            esac
        Darwin) homebrew_setup ;;
    esac
fi

# TODO Install VirtualBox guest additions
# TODO Install pip and pip3

# Generate SSH key
echo "Generating SSH key..."
mkdir "$HOME/.ssh"
if ! [ -e "$HOME/.ssh/id_rsa" ]
then
    read -p "Enter a unique name for your key: " github_keyname
    ssh-keygen -t rsa -b 4096 -C "$gh_email"
    eval "$(ssh-agent -s)"
    ssh-add "$HOME/.ssh/id_rsa"
fi

# Upload public key to GitHub
echo "Authenticating with GitHub..."
if [ ssh -T git@github.com ]
    echo "Already authenticated with GitHub."
else
    echo "Uploading public key to GitHub..."
    myjson='{"title":"'"$github_keyname"'","key":"'"$(cat $HOME/.ssh/id_rsa.pub)"'"}'
    eval "curl -u $github_username --data '$myjson' https://api.github.com/user/keys"
fi

# Install Vim, vim-plug, and Vim plugins
curl -fL -o $HOME/.vim/autoload/plug.vim --create-dirs https://raw.githubusercontent.com/junegunn/vim-plug/master/plug.vim
vim +qall
vim +PlugInstall +qall

# Install pure prompt
mkdir "$HOME/.zfunctions"
if [ ! -e "$HOME/.zfunctions/pure_prompt_setup" ] || [ ! -e "$HOME/.zfunctions/async" ]
then
    wget https://raw.githubusercontent.com/sindresorhus/pure/master/pure.zsh -O "$HOME/.zfunctions/prompt_pure_setup"
    wget https://raw.githubusercontent.com/sindresorhus/pure/master/async.zsh -O "$HOME/.zfunctions/async"
fi

# Finish setup
echo "All done! You should log out and log back in now."
