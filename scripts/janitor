#!/bin/bash
# System maintenance script

sudo -v

sudo tlmgr update --self
sudo tlmgr update --all

# Upgrade all Python 3 packages
# See https://stackoverflow.com/a/3452888/6791398
pip3 freeze --local | grep -v '^\-e' | cut -d = -f 1  | xargs -n1 pip3 install --quiet --upgrade

# Update Vim plugins
if [ -d ~/.vim/plugged ]; then
    vim +PlugInstall +qall
fi

# Operating-specific actions
case "$OSTYPE" in
    darwin*)
        mas upgrade
        brew upgrade
        brew update
        brew bundle
        brew bundle check
        brew bundle cleanup
        brew doctor
        brew style
        ;;
    linux*)
        sudo apt-get update
        sudo apt-get upgrade
        sudo apt-get clean
        sudo apt-get autoremove
        sudo apt-get check
        ;;
esac
